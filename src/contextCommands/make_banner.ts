import { createCanvas, GlobalFonts, loadImage } from '@napi-rs/canvas';
import { ApplicationCommandType, UserContextMenuCommandInteraction } from "discord.js";
import { join } from 'path';
import commandHandler from '..';
import { IContextCommand } from "../handler/interfaces/IContextCommand";
import { getTwoMostUsedColors, rgbToHex } from '../util/util';
GlobalFonts.registerFromPath(
    join(import.meta.dir, '..', '..', 'assets', 'fonts', 'VarelaRound-Regular.ttf')
)

export default {
    name: 'Make banner',
    type: ApplicationCommandType.User,
    context: 'all',
    description: "Genererates a banner for the user",
    disabled: commandHandler.prodMode,
    execute: async (interaction: UserContextMenuCommandInteraction) => {
        const width = 1400;
        const height = 500;
        const canvas = createCanvas(width, height);
        const ctx = canvas.getContext('2d');
        const { targetUser: user } = interaction;
        // Background gradient
        const gradient = ctx.createLinearGradient(0, 0, width, height);
        gradient.addColorStop(0, '#1b1d2f');
        gradient.addColorStop(1, '#0e0f17');

        // Fill background
        ctx.fillStyle = gradient;
        ctx.fillRect(0, 0, width, height);

        // Draw subtle wavy pattern (background effect)
        ctx.globalAlpha = 0.2;
        const dominatedColor = getTwoMostUsedColors(await loadImage(user.displayAvatarURL()))[0];

        ctx.strokeStyle = `rgba(${dominatedColor.join(', ')}, 0.5)`;
        const svg = `<svg class=" " viewBox="0 0 1600 800"><path d="M221.074,4C221.074,4,222.214,17.771,225.126,24.354C228.45,31.871,233.171,40.214,241.206,46.117C252.241,54.225,274.844,61.502,289.447,62.793C301.11,63.824,311.942,61.143,321.608,57.72C330.55,54.555,339.43,49.706,345.729,43.778C351.504,38.343,356.497,31.141,358.662,24.242C360.674,17.829,359.134,4,359.134,4" stroke="#60a5fa" stroke-width="8" fill="none" stroke-linecap="round" stroke-miterlimit="4"></path><path d="M574.349,436.364C575.257,443.948,581.017,454.011,587.384,460.606C594.254,467.723,604.867,472.836,615.058,476.768C626.008,480.991,637.11,484.298,651.256,484.397C671.229,484.537,707.027,477.875,723.618,470.2C733.907,465.44,740.914,458.951,745.797,452.525C749.638,447.469,752.268,441.819,752.658,436.364C753.039,431.041,751.388,425.064,748.384,420.202C744.914,414.587,739.278,409.709,731.658,405.46C720.201,399.071,700.852,392.888,683.417,390.806C663.708,388.452,637.431,388.781,619.095,394.487C603.427,399.363,585.53,410.011,578.894,418.927C574.788,424.445,573.614,430.227,574.349,436.364" stroke="#60a5fa" stroke-width="8" fill="none" stroke-linecap="round" stroke-miterlimit="4"></path><path d="M1090.399,4C1090.399,4,1134.309,14.168,1157.789,14.528C1183.381,14.92,1238.191,4.48,1238.191,4.48" stroke="#60a5fa" stroke-width="8" fill="none" stroke-linecap="round" stroke-miterlimit="4"></path><path d="M1596,743.777L1488.366,796" stroke="#60a5fa" stroke-width="8" fill="none" stroke-linecap="round" stroke-miterlimit="4"></path><path d="M150.998,4C150.998,4,154.571,36.737,160.804,50.969C166.946,64.992,176.82,79.018,187.866,88.889C198.433,98.332,210.929,104.845,225.126,109.616C241.518,115.125,262.032,117.746,281.407,117.593C302.144,117.429,325.767,113.84,345.729,107.437C364.805,101.317,384.864,91.772,398.907,80.808C410.791,71.529,421.14,61.08,426.645,48.485C432.289,35.571,431.777,4,431.777,4" stroke="#60a5fa" stroke-width="8" fill="none" stroke-linecap="round" stroke-miterlimit="4"></path><path d="M506.533,459.812C513.231,473.671,525.307,485.477,538.693,495.625C553.978,507.212,575.086,517.007,594.975,523.387C615.244,529.889,637.823,533.48,659.296,533.936C680.705,534.391,702.941,531.658,723.618,526.173C744.306,520.686,765.178,512.02,783.39,501.01C801.419,490.111,821.073,475.53,832.445,460.606C841.936,448.152,850.286,432.965,850.512,420.202C850.714,408.872,844.659,397.03,837.416,387.879C829.475,377.846,816.576,370.371,803.218,363.636C787.453,355.688,767.145,349.617,747.739,345.418C727.31,340.999,705.512,338.916,683.417,338.391C660.029,337.836,633.511,339.344,611.055,342.837C590.962,345.962,571.18,350.171,554.774,357.045C540.523,363.016,526.863,370.046,517.349,379.798C508.504,388.863,500.698,400.24,498.492,412.614C496.012,426.531,499.852,445.991,506.533,459.812" stroke="#60a5fa" stroke-width="8" fill="none" stroke-linecap="round" stroke-miterlimit="4"></path><path d="M1010.933,4C1010.933,4,1042.265,26.897,1061.307,33.583C1082.61,41.062,1108.322,43.856,1133.668,44.096C1161.654,44.362,1192.561,39.374,1222.111,32.955C1252.968,26.253,1314.909,4,1314.909,4" stroke="#60a5fa" stroke-width="8" fill="none" stroke-linecap="round" stroke-miterlimit="4"></path><path d="M1595.898,711.111C1595.898,711.111,1529.401,736.646,1499.695,751.515C1472.429,765.163,1423.867,796,1423.867,796" stroke="#60a5fa" stroke-width="8" fill="none" stroke-linecap="round" stroke-miterlimit="4"></path><path d="M101.756,4C101.756,4,105.859,52.475,113.592,72.727C120.595,91.067,130.631,108.441,143.92,121.212C157.127,133.905,174.349,142.794,192.965,149.242C214.149,156.58,239.981,159.785,265.327,160.009C293.313,160.256,325.576,156.555,353.769,148.442C381.847,140.362,412.295,128.001,434.171,111.534C453.978,96.625,473.327,76.089,481.48,56.566C488.432,39.917,485.721,4,485.721,4" stroke="#60a5fa" stroke-width="8" fill="none" stroke-linecap="round" stroke-miterlimit="4"></path><path d="M446.972,420.202C447.63,430.968,449.087,440.845,454.386,452.525C462.076,469.473,477.465,493.042,495.316,509.091C515.249,527.011,543.795,542.264,570.854,552.354C598.388,562.621,630.445,568.796,659.296,569.702C686.664,570.562,713.993,566.516,739.698,559.118C765.438,551.71,789.461,540.264,813.621,525.253C840.75,508.397,874.436,483.451,893.187,460.606C908.001,442.559,921.898,421.558,923.079,404.04C924.048,389.673,917.165,375.215,908.261,363.636C898.075,350.39,879.62,340.081,862.136,331.313C842.692,321.562,819.924,314.731,795.98,309.503C768.916,303.594,738.287,300.496,707.538,299.602C674.189,298.633,635.408,300.799,603.015,305.186C574.29,309.076,545.447,314.028,522.613,322.812C503.855,330.029,486.683,338.566,474.372,350.352C463.262,360.988,454.626,375.974,450.251,388.627C446.586,399.226,446.329,409.669,446.972,420.202" stroke="#60a5fa" stroke-width="8" fill="none" stroke-linecap="round" stroke-miterlimit="4"></path><path d="M952.081,4C952.081,4,970.278,28.495,980.905,37.703C990.75,46.235,999.019,52.489,1013.065,58.079C1034.675,66.678,1069.681,74.647,1101.508,75.343C1138.533,76.153,1180.633,67.826,1222.111,57.236C1268.738,45.331,1366.834,4.256,1366.834,4.256" stroke="#60a5fa" stroke-width="8" fill="none" stroke-linecap="round" stroke-miterlimit="4"></path><path d="M1596,682.697C1596,682.697,1513.552,716.063,1474.977,735.354C1437.785,753.953,1368.324,796,1368.324,796" stroke="#60a5fa" stroke-width="8" fill="none" stroke-linecap="round" stroke-miterlimit="4"></path><path d="M59.15,4C59.15,4,61.984,70.597,71.072,96.97C78.687,119.066,88.461,138.579,104.688,153.535C122.62,170.064,149.379,180.725,176.884,188.834C209.553,198.464,253.398,202.671,289.447,202.245C322.874,201.85,355.312,198.484,385.93,188.43C416.999,178.228,449.757,161.139,474.372,140.993C497.502,122.064,520.567,92.222,530.872,72.727C537.222,60.715,539.088,51.605,540.207,40.404C541.374,28.733,537.218,4,537.218,4" stroke="#60a5fa" stroke-width="8" fill="none" stroke-linecap="round" stroke-miterlimit="4"></path><path d="M403.583,395.96C403.493,409.549,405.626,423.127,409.266,436.364C413.039,450.08,418.679,463.765,426.207,476.768C434.317,490.776,445.217,504.963,457.087,517.172C469.237,529.669,483.65,540.918,498.492,550.706C513.508,560.608,529.732,568.803,546.734,576.142C564.49,583.807,584.04,590.813,603.015,595.406C621.57,599.898,638.416,603.522,659.296,603.638C685.451,603.784,718.411,600.946,747.739,591.704C780.086,581.511,812.232,562.995,844.221,541.915C880.626,517.925,928.19,477.628,952.769,452.525C967.638,437.34,977.254,425.435,984.636,412.121C990.667,401.244,996.307,391.215,996.242,379.798C996.168,366.876,990.333,351.096,980.905,338.564C969.011,322.756,945.487,307.928,924.623,296.931C902.803,285.43,877.93,277.763,852.261,271.88C824.58,265.536,796.973,263.033,763.819,261.454C721.549,259.442,665.038,260.989,619.095,264.668C576.961,268.041,530.577,271.968,498.492,281.367C475.6,288.074,457.113,294.796,442.211,307.342C427.964,319.338,416.359,338.115,410.05,353.991C404.588,367.736,403.674,382.096,403.583,395.96" stroke="#60a5fa" stroke-width="8" fill="none" stroke-linecap="round" stroke-miterlimit="4"></path><path d="M896.688,4C896.688,4,910.254,35.158,920.213,48.485C930.252,61.918,942.816,74.606,956.784,84.208C971.018,93.993,987.925,101.532,1005.025,106.381C1022.697,111.391,1041.906,113.011,1061.307,113.264C1082.017,113.535,1102.643,111.048,1125.628,107.098C1152.93,102.405,1179.153,96.385,1214.07,84.998C1267.737,67.496,1413.602,4,1413.602,4" stroke="#60a5fa" stroke-width="8" fill="none" stroke-linecap="round" stroke-miterlimit="4"></path><path d="M1596,655.189C1596,655.189,1488.613,702.659,1439.846,727.273C1395.419,749.696,1314.744,796,1314.744,796" stroke="#60a5fa" stroke-width="8" fill="none" stroke-linecap="round" stroke-miterlimit="4"></path><path d="M19.436,4C19.436,4,21.488,94.578,27.127,121.212C30.18,135.632,33.573,143.922,38.99,153.535C44.135,162.663,49.03,169.918,58.381,177.778C72.52,189.662,94.17,201.704,120.603,211.914C160.962,227.503,243.836,238.728,281.489,250.505C302.532,257.087,317.502,260.053,329.648,269.232C339.969,277.031,346.615,285.227,352.15,298.99C361.105,321.255,358.172,368.139,363.582,395.96C367.775,417.519,370.151,432.729,379.043,452.525C390.446,477.913,412.524,511.959,431.695,533.333C447.499,550.954,463.845,562.452,482.412,574.855C502.003,587.941,524.263,599.415,546.734,609.31C569.771,619.456,595.398,629.051,619.095,634.734C640.894,639.962,662.022,643.903,683.417,643.333C704.904,642.76,725.726,639.005,747.739,631.214C773.741,622.012,797.826,607.479,828.141,587.908C872.591,559.21,940.24,506.852,984.155,468.687C1019.418,438.042,1060.002,401.286,1074.297,379.798C1080.79,370.037,1083.162,363.761,1084.026,355.556C1084.864,347.592,1084.492,341.41,1079.817,331.313C1068.795,307.505,1004.49,246.581,992.183,226.263C987.781,218.995,984.969,215.36,985.465,210.101C985.986,204.572,988.595,199.902,996.099,193.939C1023.049,172.527,1153.19,139.072,1230.151,107.452C1307.265,75.77,1458.311,4,1458.311,4" stroke="#60a5fa" stroke-width="8" fill="none" stroke-linecap="round" stroke-miterlimit="4"></path><path d="M835.78,4C835.78,4,842.936,36.87,850.99,56.566C862.42,84.513,895.19,131.267,903.307,153.535C907.235,164.312,911.389,172.163,908.543,178.801C905.557,185.765,893.809,190.031,884.422,193.8C873.293,198.269,863.208,199.494,845.357,202.02C807.61,207.362,715.035,215.26,667.337,215.175C635.277,215.118,605.711,213.019,586.935,208.945C576.34,206.646,568.999,204.523,562.814,200.141C557.566,196.422,552.75,191.674,551.077,185.859C549.153,179.172,551.222,172.099,554.187,161.616C560.371,139.747,592.301,93.801,597.912,64.646C602.151,42.623,595.282,4,595.282,4" stroke="#60a5fa" stroke-width="8" fill="none" stroke-linecap="round" stroke-miterlimit="4"></path><path d="M1596,626.082L1258.478,796" stroke="#60a5fa" stroke-width="8" fill="none" stroke-linecap="round" stroke-miterlimit="4"></path><path d="M4,197.551C4,197.551,33.268,218.565,56.281,228.566C94.487,245.17,177.733,260.177,217.085,275.59C241.193,285.033,257.989,291.098,273.367,303.624C287.848,315.42,296.331,327.503,307.812,347.475C327.045,380.932,342.812,454.107,365.507,492.929C383.057,522.949,403.529,545.444,424.371,565.657C442.767,583.498,460.483,595.337,482.412,609.76C508.295,626.784,539.815,643.721,570.854,659.67C603.926,676.663,648.237,700.143,675.377,708.31C691.493,713.16,702.514,716.492,715.578,714.347C729.352,712.086,737.477,705.712,755.779,693.699C805.445,661.099,932.66,542.454,1013.065,482.552C1079.485,433.069,1180.794,379.863,1201.358,355.556C1207.107,348.759,1208.232,344.867,1208.709,339.394C1209.171,334.087,1207.915,329.561,1204.528,323.232C1197.842,310.74,1171.585,289.91,1161.17,274.747C1153.386,263.415,1146.722,252.708,1144.582,242.424C1142.833,234.015,1143.21,226.417,1146.132,218.182C1149.865,207.659,1157.249,197.257,1169.112,185.859C1189.602,166.171,1227.239,144.604,1268.198,121.212C1329.403,86.258,1504.94,4,1504.94,4" stroke="#60a5fa" stroke-width="8" fill="none" stroke-linecap="round" stroke-miterlimit="4"></path><path d="M1596,591.829C1596,591.829,1473.686,661.772,1408.384,694.949C1339.466,729.965,1192.396,796,1192.396,796" stroke="#60a5fa" stroke-width="8" fill="none" stroke-linecap="round" stroke-miterlimit="4"></path><path d="M4,252.672C4,252.672,132.596,280.464,176.884,298.576C206.979,310.884,230.853,323.783,248.689,339.394C262.669,351.63,268.948,362.462,279.39,379.798C295.165,405.987,312.513,456.049,328.142,484.848C339.705,506.156,348.152,520.775,361.809,538.561C377.397,558.862,394.196,576.711,418.09,599.001C453.191,631.745,529.986,681.24,556.63,711.111C570.439,726.594,576.458,737.162,582.314,751.515C588.021,765.503,591.726,796,591.726,796" stroke="#60a5fa" stroke-width="8" fill="none" stroke-linecap="round" stroke-miterlimit="4"></path><path d="M972.864,795.96C972.864,795.96,927.453,784.68,908.543,773.393C890.04,762.349,869.081,745.647,860.302,729.451C853.163,716.281,851.189,701.168,853.367,686.869C855.809,670.84,864.321,656.295,877.617,638.384C899.949,608.302,948.083,564.886,988.724,533.333C1030.542,500.867,1081.93,468.141,1125.628,446.937C1161.795,429.386,1190.637,420.001,1230.151,409.891C1279.224,397.335,1366.195,391.256,1398.995,382.582C1412.984,378.882,1424.218,377.577,1428.149,371.717C1430.983,367.493,1430.009,360.47,1427.627,355.556C1424.662,349.436,1418.292,346.221,1408.461,339.394C1383.279,321.906,1289.215,279.886,1265.16,258.586C1254.87,249.474,1250.567,243.56,1247.307,234.343C1243.928,224.789,1242.705,212.856,1245.848,202.02C1249.727,188.646,1261.384,174.704,1274.069,161.616C1290.342,144.828,1314.338,129.083,1339.071,113.131C1368.778,93.973,1405.801,74.382,1441.46,56.566C1478.812,37.904,1558.55,4,1558.55,4" stroke="#60a5fa" stroke-width="8" fill="none" stroke-linecap="round" stroke-miterlimit="4"></path><path d="M1596,538.468C1596,538.468,1539.914,590.032,1504.762,614.141C1463.22,642.634,1410.496,670.126,1360.278,694.949C1308.378,720.604,1248.564,747.782,1197.99,765.143C1155.77,779.636,1078.693,796,1078.693,796" stroke="#60a5fa" stroke-width="8" fill="none" stroke-linecap="round" stroke-miterlimit="4"></path><path d="M4,291.725C4,291.725,110.522,310.052,144.724,321.265C165.487,328.073,178.931,334.744,192.965,343.2C205.255,350.605,215.302,358.296,225.126,368.047C235.549,378.392,242.191,387.284,253.368,404.04C275.292,436.909,303.408,507.778,339.483,557.576C379.756,613.169,463.925,684.787,487.856,719.192C497.591,733.188,500.285,739.559,504.388,751.515C508.971,764.869,512.868,796,512.868,796" stroke="#60a5fa" stroke-width="8" fill="none" stroke-linecap="round" stroke-miterlimit="4"></path><path d="M1596,331.891C1596,331.891,1422.495,281.492,1378.738,258.586C1357.466,247.45,1344.105,238.619,1335.244,226.263C1328.228,216.48,1323.951,205.134,1324.797,193.939C1325.771,181.031,1334.615,166.556,1344.982,153.535C1358.45,136.619,1381.418,120.237,1403.809,105.051C1429.537,87.601,1460.909,71.156,1492.013,56.566C1524.785,41.193,1596,15.679,1596,15.679" stroke="#60a5fa" stroke-width="8" fill="none" stroke-linecap="round" stroke-miterlimit="4"></path><path d="M958.499,597.98C977.813,575.735,1006.506,552.564,1033.024,533.333C1059.536,514.107,1088.378,496.427,1117.588,482.607C1146.096,469.12,1174.883,458.302,1206.03,450.974C1239.003,443.217,1275.683,439.075,1310.553,438.517C1345.365,437.959,1383.757,441.209,1415.075,447.59C1441.751,453.024,1470.288,462.235,1487.437,471.197C1498.248,476.846,1505.52,482.562,1511.558,489.446C1516.777,495.396,1520.885,501.927,1522.728,509.091C1524.638,516.511,1524.566,524.946,1522.408,533.333C1519.754,543.645,1514.555,554.036,1505.143,565.657C1489.568,584.888,1458.783,609.81,1428.371,630.303C1391.013,655.475,1340.093,681.127,1294.472,701.04C1249.856,720.515,1199.874,738.919,1157.789,748.946C1123.293,757.165,1091.957,762.249,1061.307,761.627C1033.24,761.057,1003.831,757.264,980.905,747.721C960.725,739.32,939.373,723.5,929.369,711.111C922.906,703.108,920.363,695.723,918.963,686.869C917.41,677.047,917.89,666.269,921.943,654.545C927.781,637.659,942.54,616.36,958.499,597.98" stroke="#60a5fa" stroke-width="8" fill="none" stroke-linecap="round" stroke-miterlimit="4"></path><path d="M4,326.04C4,326.04,97.705,338.631,128.643,348.88C148.385,355.419,161.17,362.597,174.908,371.717C187.76,380.249,196.093,385.82,209.045,401.269C236.362,433.853,276.28,520.366,311.987,573.737C344.974,623.043,395.213,678.098,414.515,711.111C424.315,727.873,428.261,737.44,432.412,751.515C436.602,765.724,439.433,796,439.433,796" stroke="#60a5fa" stroke-width="8" fill="none" stroke-linecap="round" stroke-miterlimit="4"></path><path d="M1005.451,597.98C1019.238,580.577,1039.582,563.989,1059.227,549.495C1079.525,534.519,1102.471,520.871,1125.628,509.909C1148.73,498.974,1172.892,489.911,1197.99,483.772C1223.761,477.468,1251.555,473.659,1278.392,472.999C1305.157,472.341,1334.3,474.473,1358.794,479.771C1380.496,484.464,1403.145,490.659,1418.466,501.01C1431.114,509.555,1443.854,521.049,1447.07,533.333C1450.216,545.355,1445.65,560.737,1438.356,573.737C1428.842,590.695,1408.471,606.799,1387.405,622.222C1360.437,641.968,1321.054,662.434,1286.432,677.83C1252.517,692.911,1215.686,705.984,1181.91,714.031C1151.57,721.26,1120.59,726.23,1093.467,725.989C1070.307,725.783,1047.675,723.46,1029.146,716.124C1012.633,709.587,994.773,699.444,986.544,686.869C979.202,675.648,976.621,660.149,978.781,646.465C981.286,630.594,993.398,613.193,1005.451,597.98" stroke="#60a5fa" stroke-width="8" fill="none" stroke-linecap="round" stroke-miterlimit="4"></path><path d="M1596,283.026C1596,283.026,1530.984,268.159,1503.518,259.139C1480.593,251.611,1458.625,243.767,1441.77,234.343C1428.585,226.972,1416.504,220.079,1409.058,210.101C1402.215,200.93,1396.898,188.472,1397.293,177.778C1397.695,166.921,1404.026,155.993,1411.844,145.455C1422.141,131.577,1440.936,117.127,1458.178,105.051C1476.599,92.148,1497.604,81.201,1519.598,71.11C1543.3,60.236,1596,42.748,1596,42.748" stroke="#60a5fa" stroke-width="8" fill="none" stroke-linecap="round" stroke-miterlimit="4"></path><path d="M4,359.589C4,359.589,44.948,361.135,64.322,364.641C82.944,368.01,101.636,372.909,118.155,379.798C133.621,386.248,148.17,394.326,160.804,403.979C172.993,413.292,179.87,419.098,192.952,436.364C226.331,480.422,314.75,639.19,339.293,694.949C350.274,719.897,354.574,733.578,357.68,751.515C360.366,767.031,358.953,796,358.953,796" stroke="#60a5fa" stroke-width="8" fill="none" stroke-linecap="round" stroke-miterlimit="4"></path><path d="M35.169,796L4.709,767.677" stroke="#60a5fa" stroke-width="8" fill="none" stroke-linecap="round" stroke-miterlimit="4"></path><path d="M1059.948,597.98C1068.741,586.415,1081.426,575.455,1094.407,565.657C1108.43,555.071,1124.849,545.352,1141.709,537.316C1159.282,528.94,1178.983,521.634,1197.99,516.787C1216.516,512.063,1235.468,509.092,1254.271,508.305C1272.99,507.521,1293.568,508.63,1310.553,512.018C1325.29,514.957,1339.857,518.781,1350.754,525.691C1360.375,531.792,1370.783,540.104,1373.76,549.495C1376.72,558.83,1373.708,571.766,1368.733,581.818C1362.91,593.582,1350.938,603.761,1337.709,614.141C1320.272,627.823,1293.883,642.374,1270.352,653.136C1246.726,663.941,1220.14,672.94,1196.211,678.788C1174.731,684.037,1153.978,687.829,1133.668,688.004C1114.425,688.169,1092.311,686.251,1077.387,680.699C1066.039,676.477,1055.728,671,1049.996,662.626C1044.242,654.22,1041.579,640.825,1043.007,630.303C1044.507,619.25,1052.221,608.144,1059.948,597.98" stroke="#60a5fa" stroke-width="8" fill="none" stroke-linecap="round" stroke-miterlimit="4"></path><path d="M1596,237.275C1596,237.275,1527.62,219.579,1508.208,210.101C1497.438,204.843,1491.019,200.748,1484.995,193.939C1479.064,187.236,1473.12,177.965,1472.185,169.697C1471.29,161.788,1474.499,153.062,1478.656,145.455C1483.409,136.755,1491.835,128.756,1500.759,121.212C1511.184,112.399,1524.116,104.276,1538.405,96.97C1555.199,88.382,1596,74.414,1596,74.414" stroke="#60a5fa" stroke-width="8" fill="none" stroke-linecap="round" stroke-miterlimit="4"></path><path d="M4,395.716C4,395.716,45.584,396.403,64.322,400.397C81.562,404.073,97.799,409.53,112.563,417.604C127.269,425.646,140.921,436.276,152.764,448.69C165.201,461.727,173.767,474.49,184.925,494.59C203.025,527.196,229.117,591.687,242.68,630.303C252.386,657.937,260.972,679.695,263.059,703.03C264.934,723.999,262.72,749.456,257.286,763.741C253.814,772.871,248.711,778.479,242.567,783.838C236.346,789.266,220.095,796,220.095,796" stroke="#60a5fa" stroke-width="8" fill="none" stroke-linecap="round" stroke-miterlimit="4"></path><path d="M165.453,796C165.453,796,120.253,778.467,96.482,763.731C66.866,745.371,4,690.119,4,690.119" stroke="#60a5fa" stroke-width="8" fill="none" stroke-linecap="round" stroke-miterlimit="4"></path><path d="M1161.7,581.818C1173.286,573.643,1191.322,566.576,1206.03,563.111C1219.488,559.94,1234.505,558.185,1246.231,560.556C1256.274,562.586,1269.126,567.685,1272.675,573.737C1275.301,578.216,1274.005,584.864,1271.903,589.899C1269.454,595.764,1264.31,600.864,1257.046,606.061C1245.02,614.664,1220.226,626.462,1201.963,630.303C1185.419,633.783,1163.076,633.561,1152.573,630.303C1146.926,628.551,1143.02,626.059,1140.8,622.222C1138.434,618.133,1137.619,611.567,1139.51,606.061C1142.202,598.221,1152.124,588.574,1161.7,581.818" stroke="#60a5fa" stroke-width="8" fill="none" stroke-linecap="round" stroke-miterlimit="4"></path><path d="M1596,166.704C1596,166.704,1585.23,158.562,1584.749,153.535C1584.198,147.77,1596,133.724,1596,133.724" stroke="#60a5fa" stroke-width="8" fill="none" stroke-linecap="round" stroke-miterlimit="4"></path><path d="M4,442.384C4,442.384,46.214,441.906,64.322,448.02C81.462,453.808,97.689,464.157,110.369,476.768C123.404,489.73,133.816,507.187,141.013,525.253C148.727,544.615,154.244,570.919,153.754,589.899C153.364,604.991,150.924,620.195,143.599,630.303C136.724,639.789,124.571,647.47,112.563,649.883C98.699,652.669,80.828,647.405,64.322,641.791C44.81,635.156,4,609.662,4,609.662" stroke="${rgbToHex(dominatedColor)}" stroke-width="8" fill="none" stroke-linecap="round" stroke-miterlimit="4"></path></svg>`
        const url = 'data:image/svg+xml;base64,' + Buffer.from(svg).toString('base64');
        const img = await loadImage(url)
        ctx.drawImage(img, 0, 0, width, height);
        // draw svg
        ctx.stroke
        ctx.globalAlpha = 1.0;

        // Add glowing 'ryz' text
        ctx.font = 'bold 120px sans-serif';
        ctx.textAlign = 'center';
        ctx.textBaseline = 'middle';
        ctx.shadowColor = '#ffffff';
        ctx.shadowBlur = 20;
        ctx.fillStyle = '#ffffff';
        ctx.fillText(user.displayName, width / 2, height / 2 - 50);

        // Add glowing 'evade.rest' text
        ctx.font = '50px sans-serif';
        ctx.shadowBlur = 10;
        ctx.fillStyle = '#a3a3a3';
        ctx.fillText('evade.rest', width / 2, height / 2 + 80);

        // Save image to file
        const buffer = canvas.toBuffer('image/png');
        return { files: [buffer] };
    }
} as IContextCommand